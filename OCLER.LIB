(CLEAR VC VARIABLES)
OCLER

(MACHINE: MU6300V-L - OSP P500)
(PROGRAMMER: JUSTIN BROWN)
(REV: 0)
(DATE: 07/27/2024)

(PASS IN VARIABLES REQUIRED:)
( PSRT = START OF VC# TO CLEAR)
( PEND = STOP VC# - WILL DELETE THIS, BUT NOTHING PAST THIS)

(CALLING THIS SUB:)
( CALL OCLER PSRT=VC# PEND=VC#)
( EX: CALL OCLER PSRT=1 PEND=10 -- WILL CLEAR VC1 - VC10)

(CHECK VALID INPUTS)
    IF [PSRT EQ EMPTY] NALM1
    IF [PEND EQ EMPTY] NALM2
    IF [PEND LT PSRT] NALM3
    IF [PSRT LT 1] NALM4
    IF [PSPT GT 1000] NALM5

(SET VARIABLES)
    CNTR = PSRT (SET TO VC# START)

(LOOP FROM STRT TO STOP)
    WHILE [CNTR LE PEND] DO 1
        VC[CNTR] = EMPTY
        CNTR = CNTR + 1
    END 1

(SKIP ALARMS - PGM SUCCESSFUL)
GOTO NEND

(ALARMS)
    NALM1
        VUACM[1]='PSRT IS MISSING'
        VDOUT[993]=9001
    NALM2
        VUACM[1]='PEND IS MISSING'
        VDOUT[993]=9001
    NALM3
        VUACM[1]='PEND LT PSRT'
        VDOUT[993]=9001
    NALM4
        VUACM[1]='PSRT CANT BE 0'
        VDOUT[993]=9001
    NALM4
        VUACM[1]='PSPT OVER 1000'
        VDOUT[993]=9001

NEND
RTS
