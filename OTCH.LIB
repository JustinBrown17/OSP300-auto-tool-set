(TOOL TEACH W/ SPINDLE POSITION)
OTCH

(MACHINE: MU6300V-L - OSP P500)
(TOUCH SETTER: RIGHT ANGLE STYLE)
(PROGRAMMER: JUSTIN BROWN)
(REV: 0)
(DATE: 07/27/2024)


(TO CALL THIS PROGRAM:)
    (CALL OTCH PX= PY=5.5 PRS=240)

(VALIDATE PASSED VARIABLES)
    IF[PX LT 0] NALMX1
    IF[PX EQ EMPTY] NALMX2
    
    IF[PY NE 0] NALMY1
    IF[PY EQ EMPTY] NALMY2

    IF[PRS EQ EMPTY] NALMR1
    IF[PRS LT 0] NALMR2
    IF[PRS GE 360] NALMR3 

    IF[VTLCN EQ 999] NALMT

    (BREAK OR LENGTH)
      IF[PBRK NE 1] NLEN

    NBRK (BREAK DETECT)
      M144
      VFST=#80H (BREAK)
      CALL OO30 PLE1=2.000 PX=PX PRS=PRS PGO=1
      M145
      GOTO NEND

    NLEN (SET LENGTH)
      M144
      VFST=#81H (LENGTH)
      CALL OO30 PX=PX PRS=PRS
      M145
      GOTO NEND


(ALARMS)
  (PX)
    NALMX1
    VUACM[1]='PX MUST BE POS.'
    VDOUT[993]=9001

    NALMX2
    VUACM[1]='PX IS MISSING'
    VDOUT[993]=9001

  (PY)
    NALMY1
    VUACM[1]='PY MUST BE ZERO'
    VDOUT[993]=9001

    NALMY2
    VUACM[1]='PY IS MISSING'
    VDOUT[993]=9001

  (PRS)
    NALMR1
    VUACM[1]='PRS IS MISSING'
    VDOUT[993]=9001
    
    NALMR2
    VUACM[1]='PRS LESS THAN 0'
    VDOUT[993]=9001
    
    NALMR3
    VUACM[1]='PRS OVER 360 DEG'
    VDOUT[993]=9001

  (ATTEMPTED TO SET PROBE)
    NALMT
    VUACM[1]='CANNOT SET PROBE'
    VDOUT[993]=9001


NEND
RTS
